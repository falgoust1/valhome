/**
 * geostats.js
 * Class for statistical classification
 * (C) 2012-2022 Simon Guyomarch
 * Licensed under MIT License
 * https://github.com/simogeo/geostats
 */
var geostats=function(){var f=function(a,b,c){var d=b-a;return 0===d?0:(c-a)/d},g=function(a){return Math.sqrt(a)},h=function(a){for(var b,c=0,d=0,e=a.length;e--;)b=parseFloat(a[e]),isNaN(b)||(c+=b,d++);return c/d},i=function(a,b){for(var c=[],d=0,e=a.length;e--;)parseFloat(a[e])>=b&&c.push(parseFloat(a[e]));return c},j=function(a){var b=a.slice();return b.sort(function(a,b){return a-b}),b},k=function(a,b){for(var c=[],d=0;d<a.length-1;d++){for(var e=[],f=0,g=a.length;g--;)a[g]>=a[d]&&a[g]<a[d+1]&&e.push(a[g]);c.push(e)}return c};return function(a){if(void 0===a&&(a=[]),!this instanceof geostats)return new geostats(a);this.serie=a,this.sorted=this.serie.slice().sort(function(a,b){return a-b}),this.min=this.sorted[0],this.max=this.sorted[this.sorted.length-1],this.pop=this.serie.length,this.sum=function(){for(var a=0,b=this.serie.length;b--;)a+=parseFloat(this.serie[b]);return a},this.mean=function(){return this.sum()/this.pop},this.stddev=function(){for(var a=this.mean(),b=0,c=this.pop;c--;)b+=Math.pow(parseFloat(this.serie[c])-a,2);return g(b/this.pop)},this.getClassEqInterval=function(a){var b=[],c=(this.max-this.min)/a;for(var d=0;d<a+1;d++)b.push(this.min+d*c);return b},this.getClassQuantile=function(a){for(var b=[],c=this.sorted,d=c.length,e=0;e<a;e++)b.push(c[Math.floor(e*d/a)]);return b.push(c[c.length-1]),b},this.getClassJenks=function(a){for(var b=this.sorted,c=b.length,d=Array(c+1).fill(0).map(function(){return Array(a+1).fill(0)}),e=Array(c+1).fill(0).map(function(){return Array(a+1).fill(0)}),f=0;f<=a;f++)d[0][f]=1,e[0][f]=0;for(var f=1;f<=c;f++){d[f][0]=0,e[f][0]=1/0}for(var f=1;f<=c;f++){for(var g=0,h=0,i=0,j=0,k=1;k<=f;k++){var l=b[f-k];g+=l,h+=l*l,i++;var m=h-g*g/i,n=f,i=m+e[f-k][j];e[f][j+1]>=i&&(d[f][j+1]=f-k+1,e[f][j+1]=i)}}for(var n=Array(a+1).fill(0),o=c,p=a+1;o>=1;){var q=d[o][p]-1;n[p-1]=b[q],o=d[o][p]-1,p--}return n[0]=b[0],n},this.getRanges=function(a){for(var b=[],c=0;c<a.length-1;c++)b.push([a[c],a[c+1]]);return b},this.getHtmlLegend=function(a,b,c,d,e){var f=this.getRanges(a),g="<ul>";return f.forEach(function(a){g+="<li>",g+=(e?"<span style='background:"+e+";'>":"")+"["+a[0]+" - "+a[1]+"]",g+=e?"</span>":"",g+="</li>"}),g+="</ul>",""===g?"No legend":g}}}();